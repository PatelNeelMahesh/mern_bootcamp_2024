# ** 3 — Second Normal Form (2NF): Removing Partial Dependencies**

---

## **1. Building Intuition — Why Do We Need Another Step After 1NF?**

At this stage our data is already in **First Normal Form**:

* Every column has a single value,
* Each row represents one holding record.

That feels organized — but not *efficient*.
If we look closer, we’re still writing the same information over and over again.

---

### **Let’s Imagine the Situation**

You run a small system that tracks investors’ mutual-fund holdings.

Every time someone buys or sells, you add a new record that includes:

* Investor details (name, phone)
* Fund details (name, category, NAV)
* Units and purchase date

At first this looks fine. But over time:

1. **Repetition everywhere** — “Arjun Patel” and his phone number appear dozens of times.
2. **Risk of inconsistent updates** — change his phone number once, forget another row, and you have conflicting data.
3. **Wasted storage and slow updates** — same fund info repeated across many records.

This happens because we’re mixing information about **different entities** (investors, funds, transactions) in one place.

That’s what **Second Normal Form (2NF)** fixes.

---

## **2. The Big Idea Behind 2NF**

In simple terms:

> **2NF ensures that every non-key piece of information depends on the *whole* record — not just part of it.**

If your table uses a **composite key** (a key made of several columns), some attributes might rely on only one part of that key.
That partial dependence is what we need to remove.

---

### **A Simple Analogy**

Think of your database like a filing cabinet:

* One drawer labeled **Investors**,
* Another labeled **Funds**,
* A third labeled **Transactions**.

In your old design (1NF), all three were jammed into one drawer — messy and repetitive.
2NF is simply *moving each type of information into its proper drawer* and linking them with IDs.

---

## **3. What We Currently Have (from 1NF)**

| HoldingID | InvestorID | InvestorName | Mobile     | FundName            | Category  | Units | NAV    | InvestDate |
| --------- | ---------- | ------------ | ---------- | ------------------- | --------- | ----- | ------ | ---------- |
| H001      | I001       | Arjun Patel  | 9991112222 | Axis Bluechip Fund  | Large Cap | 100   | 45.30  | 2025-01-10 |
| H002      | I001       | Arjun Patel  | 9991112222 | ICICI Balanced Fund | Hybrid    | 50    | 120.50 | 2025-02-15 |
| H003      | I002       | Yashvi Shah  | 9993334444 | Axis Bluechip Fund  | Large Cap | 200   | 45.30  | 2025-03-05 |
| H004      | I002       | Yashvi Shah  | 9993334444 | ICICI Balanced Fund | Hybrid    | 30    | 120.50 | 2025-04-01 |
| H005      | I003       | Mahir Mehta  | 9995556666 | HDFC Small Cap Fund | Small Cap | 150   | 25.80  | 2025-02-25 |

It’s atomic — but **investor** and **fund** details repeat in almost every row.

---

## **4. Understanding Partial Dependencies**

Assume the natural key is `(InvestorID, FundName, InvestDate)` — that trio uniquely identifies a holding.

Now examine each attribute:

| Attribute                 | Depends On | Explanation                               |
| ------------------------- | ---------- | ----------------------------------------- |
| **InvestorName**          | InvestorID | depends only on part of the key → partial |
| **Mobile**                | InvestorID | depends only on part of the key → partial |
| **Category**              | FundName   | partial again                             |
| **NAV**                   | FundName   | partial again                             |
| **Units**, **InvestDate** | Full key   | depend on the whole record                |

Whenever something depends only on part of a composite key, we have redundancy.
That’s what 2NF eliminates.

---

## **5. The Fix — Split the Table**

We separate our single big table into three focused ones.

---

### **A. Investors**

| InvestorID | InvestorName | Mobile     |
| ---------- | ------------ | ---------- |
| I001       | Arjun Patel  | 9991112222 |
| I002       | Yashvi Shah  | 9993334444 |
| I003       | Mahir Mehta  | 9995556666 |

---

### **B. Funds**

| FundID | FundName            | Category  | NAV    |
| ------ | ------------------- | --------- | ------ |
| F001   | Axis Bluechip Fund  | Large Cap | 45.30  |
| F002   | ICICI Balanced Fund | Hybrid    | 120.50 |
| F003   | HDFC Small Cap Fund | Small Cap | 25.80  |

---

### **C. Holdings (Transactions)**

| HoldingID | InvestorID | FundID | Units | InvestDate |
| --------- | ---------- | ------ | ----- | ---------- |
| H001      | I001       | F001   | 100   | 2025-01-10 |
| H002      | I001       | F002   | 50    | 2025-02-15 |
| H003      | I002       | F001   | 200   | 2025-03-05 |
| H004      | I002       | F002   | 30    | 2025-04-01 |
| H005      | I003       | F003   | 150   | 2025-02-25 |

Now each table stores information about a **single concept**:

* Investors → one record per person
* Funds → one record per mutual fund
* Holdings → the relationship between them

---

## **6. SQL Implementation**

```sql
-- Investors
CREATE TABLE Investors (
  InvestorID VARCHAR(10) PRIMARY KEY,
  InvestorName VARCHAR(100),
  Mobile VARCHAR(15)
);

-- Funds
CREATE TABLE Funds (
  FundID VARCHAR(10) PRIMARY KEY,
  FundName VARCHAR(200),
  Category VARCHAR(50),
  NAV DECIMAL(10,2)
);

-- Holdings
CREATE TABLE Holdings (
  HoldingID VARCHAR(10) PRIMARY KEY,
  InvestorID VARCHAR(10),
  FundID VARCHAR(10),
  Units DECIMAL(12,4),
  InvestDate DATE,
  FOREIGN KEY (InvestorID) REFERENCES Investors(InvestorID),
  FOREIGN KEY (FundID) REFERENCES Funds(FundID)
);
```

---

## **7. Checking Our Progress**

| Issue                  | In 1NF | After 2NF |
| ---------------------- | ------ | --------- |
| Repeated investor data | ✅      | ❌         |
| Repeated fund data     | ✅      | ❌         |
| Update anomalies       | ✅      | ❌         |
| Insert anomalies       | ✅      | ❌         |
| Delete anomalies       | ✅      | ❌         |

2NF has eliminated all partial-dependency-based redundancy.

---

## **8. Example Queries**

**a. Fetch all holdings with details**

```sql
SELECT i.InvestorName, f.FundName, f.Category,
       h.Units, h.InvestDate
FROM Holdings h
JOIN Investors i ON h.InvestorID = i.InvestorID
JOIN Funds f ON h.FundID = f.FundID;
```

**b. Find total units held by each investor**

```sql
SELECT i.InvestorName, SUM(h.Units) AS TotalUnits
FROM Holdings h
JOIN Investors i ON h.InvestorID = i.InvestorID
GROUP BY i.InvestorName;
```

---

## **9. Why 2NF Matters**

* **Efficiency:** One place to update each fact.
* **Clarity:** Each table focuses on one type of information.
* **Accuracy:** No mismatched investor or fund details.
* **Scalability:** Add new funds or investors without breaking anything.

---

## **10. Recap**

| Concept            | Meaning                                      | Mutual-Fund Example                            |
| ------------------ | -------------------------------------------- | ---------------------------------------------- |
| Partial Dependency | Attribute depends on part of a composite key | InvestorName → InvestorID; Category → FundName |
| 2NF Rule           | Remove partial dependencies                  | Split into Investors, Funds, Holdings          |
| Result             | Every attribute depends on the whole key     | Clean, non-redundant data                      |

---
